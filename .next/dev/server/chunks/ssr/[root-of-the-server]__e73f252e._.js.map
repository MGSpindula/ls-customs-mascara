{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/ls-customs-mascara/src/lib/mongo.js"],"sourcesContent":["import mongoose from 'mongoose';\n\nexport async function connectDB() {\n  if (mongoose.connection.readyState >= 1) return;\n\n  await mongoose.connect(process.env.MONGO_URI);\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe;IACpB,IAAI,oHAAQ,CAAC,UAAU,CAAC,UAAU,IAAI,GAAG;IAEzC,MAAM,oHAAQ,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,SAAS;AAC9C"}},
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/ls-customs-mascara/src/models/Item.js"],"sourcesContent":["import mongoose from 'mongoose';\n\nconst ComponentSchema = new mongoose.Schema({\n  item: { type: mongoose.Schema.Types.ObjectId, ref: 'Item', required: true },\n  qty: { type: Number, required: true }\n});\n\nconst ItemSchema = new mongoose.Schema({\n  name: { type: String, required: true },\n  type: { type: String, enum: ['raw', 'manufactured'], required: true },\n  purchasePrice: { type: Number },\n  components: [ComponentSchema],\n  stock: { type: Number, default: 0 }\n});\n\n// Dynamic net price calculation\nItemSchema.methods.getNetPrice = async function() {\n  if (this.type === 'raw') return this.purchasePrice;\n\n  let total = 0;\n\n  for (const comp of this.components) {\n    const item = await mongoose.model('Item').findById(comp.item);\n\n    // Safe check: skip missing raw materials\n    if (!item) {\n      console.warn(`Component item missing: ${comp.item}`);\n      continue;\n    }\n\n    // Safe recursive price call\n    const price = await item.getNetPrice();\n    total += price * comp.qty;\n  }\n\n  return total;\n};\n\nexport default mongoose.models.Item || mongoose.model('Item', ItemSchema);\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB,IAAI,oHAAQ,CAAC,MAAM,CAAC;IAC1C,MAAM;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;IAAK;IAC1E,KAAK;QAAE,MAAM;QAAQ,UAAU;IAAK;AACtC;AAEA,MAAM,aAAa,IAAI,oHAAQ,CAAC,MAAM,CAAC;IACrC,MAAM;QAAE,MAAM;QAAQ,UAAU;IAAK;IACrC,MAAM;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAO;SAAe;QAAE,UAAU;IAAK;IACpE,eAAe;QAAE,MAAM;IAAO;IAC9B,YAAY;QAAC;KAAgB;IAC7B,OAAO;QAAE,MAAM;QAAQ,SAAS;IAAE;AACpC;AAEA,gCAAgC;AAChC,WAAW,OAAO,CAAC,WAAW,GAAG;IAC/B,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,OAAO,IAAI,CAAC,aAAa;IAElD,IAAI,QAAQ;IAEZ,KAAK,MAAM,QAAQ,IAAI,CAAC,UAAU,CAAE;QAClC,MAAM,OAAO,MAAM,oHAAQ,CAAC,KAAK,CAAC,QAAQ,QAAQ,CAAC,KAAK,IAAI;QAE5D,yCAAyC;QACzC,IAAI,CAAC,MAAM;YACT,QAAQ,IAAI,CAAC,CAAC,wBAAwB,EAAE,KAAK,IAAI,EAAE;YACnD;QACF;QAEA,4BAA4B;QAC5B,MAAM,QAAQ,MAAM,KAAK,WAAW;QACpC,SAAS,QAAQ,KAAK,GAAG;IAC3B;IAEA,OAAO;AACT;uCAEe,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAC,QAAQ"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/ls-customs-mascara/src/lib/errors.js"],"sourcesContent":["export class DependencyError extends Error {\n  constructor(message) {\n    super(message);\n    this.name = 'DependencyError';\n  }\n}\n"],"names":[],"mappings":";;;;AAAO,MAAM,wBAAwB;IACnC,YAAY,OAAO,CAAE;QACnB,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;IACd;AACF"}},
    {"offset": {"line": 101, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/ls-customs-mascara/src/lib/itemsActions.js"],"sourcesContent":["\"use server\";\n\nimport { connectDB } from \"./mongo\";\nimport Item from \"../models/Item\";\nimport { DependencyError } from \"./errors\";\n\nexport async function createRaw(name, purchasePrice) {\n  try {\n    if (!name || purchasePrice == null) throw new Error(\"Missing required fields\");\n\n    await connectDB();\n    return await Item.create({\n      name,\n      type: \"raw\",\n      purchasePrice\n    });\n  } catch (err) {\n    throw new Error(`Failed to create raw item: ${err.message}`);\n  }\n}\n\nexport async function createManufactured(name, components) {\n  try {\n    if (!name || !components) throw new Error(\"Missing required fields\");\n\n    await connectDB();\n    return await Item.create({\n      name,\n      type: \"manufactured\",\n      components\n    });\n  } catch (err) {\n    throw new Error(`Failed to create manufactured item: ${err.message}`);\n  }\n}\n\nexport async function addStock(id, amount = 1) {\n  try {\n    await connectDB();\n\n    const item = await Item.findById(id);\n    if (!item) throw new Error(\"Item not found\");\n\n    item.stock += amount;\n    await item.save();\n\n    return item.stock;\n  } catch (err) {\n    throw new Error(`Failed to add stock: ${err.message}`);\n  }\n}\n\nexport async function removeStock(id, amount = 1) {\n  try {\n    await connectDB();\n\n    const item = await Item.findById(id);\n    if (!item) throw new Error(\"Item not found\");\n\n    item.stock -= amount;\n    if (item.stock < 0) item.stock = 0;\n    await item.save();\n\n    return item.stock;\n  } catch (err) {\n    throw new Error(`Failed to remove stock: ${err.message}`);\n  }\n}\n\nexport async function deleteItem(id) {\n  try {\n    await connectDB();\n\n    const dependentCount = await Item.countDocuments({ \"components.item\": id });\n    if (dependentCount > 0) throw new DependencyError(\"Cannot delete. It is used in manufactured items\");\n\n    await Item.findByIdAndDelete(id);\n    return true;\n  } catch (err) {\n    if (err instanceof DependencyError) throw err;\n    throw new Error(`Failed to delete item: ${err.message}`);\n  }\n}\n\nexport async function listItems() {\n  try {\n    await connectDB();\n    const items = await Item.find().populate(\"components.item\");\n\n    const data = [];\n    for (const itm of items) {\n      const netPrice = await itm.getNetPrice();\n      data.push({\n        _id: itm._id,\n        name: itm.name,\n        type: itm.type,\n        netPrice,\n        stock: itm.stock,\n        components: itm.components\n      });\n    }\n    return data;\n  } catch (err) {\n    throw new Error(`Failed to list items: ${err.message}`);\n  }\n}\n\nexport async function searchItems(query) {\n  try {\n    await connectDB();\n    const results = await Item.find({ name: { $regex: query, $options: \"i\" } })\n      .limit(10)\n      .lean();\n    return results;\n  } catch (err) {\n    throw new Error(`Failed to search items: ${err.message}`);\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 249, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/ls-customs-mascara/src/actions/items.js"],"sourcesContent":["\"use server\";\n\nimport {\n  createRaw,\n  createManufactured,\n  addStock,\n  removeStock,\n  deleteItem,\n  listItems,\n  searchItems\n} from \"../lib/itemsActions\";\n\nexport async function addRawAction({ name, purchasePrice }) {\n  try {\n    const item = await createRaw(name, purchasePrice);\n    return { success: true, data: JSON.parse(JSON.stringify(item)) };\n  } catch (err) {\n    return {\n      success: false,\n      error: err.message || \"Failed to add raw item\"\n    };\n  }\n}\n\nexport async function addManufacturedAction({ name, components }) {\n  try {\n    const item = await createManufactured(name, components);\n    return { success: true, data: JSON.parse(JSON.stringify(item)) };\n  } catch (err) {\n    return {\n      success: false,\n      error: err.message || \"Failed to add manufactured item\"\n    };\n  }\n}\n\nexport async function addStockAction(id, amount = 1) {\n  try {\n    const stock = await addStock(id, amount);\n    return { success: true, stock };\n  } catch (err) {\n    return {\n      success: false,\n      error: err.message || `Failed to add stock for item ${id}`\n    };\n  }\n}\n\nexport async function removeStockAction(id, amount = 1) {\n  try {\n    const stock = await removeStock(id, amount);\n    return { success: true, stock };\n  } catch (err) {\n    return {\n      success: false,\n      error: err.message || `Failed to remove stock for item ${id}`\n    };\n  }\n}\n\nexport async function deleteItemAction(id) {\n  try {\n    await deleteItem(id);\n    return { success: true };\n  } catch (err) {\n    return {\n      success: false,\n      error:\n        err.name === \"DependencyError\"\n          ? err.message\n          : err.message || `Failed to delete item ${id}`\n    };\n  }\n}\n\nexport async function listItemsAction() {\n  try {\n    const items = await listItems();\n    return {\n      success: true,\n      data: JSON.parse(JSON.stringify(items))\n    };\n  } catch (err) {\n    return {\n      success: false,\n      error: err.message || \"Failed to list items\"\n    };\n  }\n}\n\nexport async function searchItemsAction(query) {\n  try {\n    const results = await searchItems(query);\n    return { success: true, data: JSON.parse(JSON.stringify(results)) };\n  } catch (err) {\n    return { success: false, error: err.message };\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAEA;;;;;AAUO,eAAe,aAAa,EAAE,IAAI,EAAE,aAAa,EAAE;IACxD,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,uIAAS,EAAC,MAAM;QACnC,OAAO;YAAE,SAAS;YAAM,MAAM,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC;QAAO;IACjE,EAAE,OAAO,KAAK;QACZ,OAAO;YACL,SAAS;YACT,OAAO,IAAI,OAAO,IAAI;QACxB;IACF;AACF;AAEO,eAAe,sBAAsB,EAAE,IAAI,EAAE,UAAU,EAAE;IAC9D,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,gJAAkB,EAAC,MAAM;QAC5C,OAAO;YAAE,SAAS;YAAM,MAAM,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC;QAAO;IACjE,EAAE,OAAO,KAAK;QACZ,OAAO;YACL,SAAS;YACT,OAAO,IAAI,OAAO,IAAI;QACxB;IACF;AACF;AAEO,eAAe,eAAe,EAAE,EAAE,SAAS,CAAC;IACjD,IAAI;QACF,MAAM,QAAQ,MAAM,IAAA,sIAAQ,EAAC,IAAI;QACjC,OAAO;YAAE,SAAS;YAAM;QAAM;IAChC,EAAE,OAAO,KAAK;QACZ,OAAO;YACL,SAAS;YACT,OAAO,IAAI,OAAO,IAAI,CAAC,6BAA6B,EAAE,IAAI;QAC5D;IACF;AACF;AAEO,eAAe,kBAAkB,EAAE,EAAE,SAAS,CAAC;IACpD,IAAI;QACF,MAAM,QAAQ,MAAM,IAAA,yIAAW,EAAC,IAAI;QACpC,OAAO;YAAE,SAAS;YAAM;QAAM;IAChC,EAAE,OAAO,KAAK;QACZ,OAAO;YACL,SAAS;YACT,OAAO,IAAI,OAAO,IAAI,CAAC,gCAAgC,EAAE,IAAI;QAC/D;IACF;AACF;AAEO,eAAe,iBAAiB,EAAE;IACvC,IAAI;QACF,MAAM,IAAA,wIAAU,EAAC;QACjB,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,KAAK;QACZ,OAAO;YACL,SAAS;YACT,OACE,IAAI,IAAI,KAAK,oBACT,IAAI,OAAO,GACX,IAAI,OAAO,IAAI,CAAC,sBAAsB,EAAE,IAAI;QACpD;IACF;AACF;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,QAAQ,MAAM,IAAA,uIAAS;QAC7B,OAAO;YACL,SAAS;YACT,MAAM,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC;QAClC;IACF,EAAE,OAAO,KAAK;QACZ,OAAO;YACL,SAAS;YACT,OAAO,IAAI,OAAO,IAAI;QACxB;IACF;AACF;AAEO,eAAe,kBAAkB,KAAK;IAC3C,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,yIAAW,EAAC;QAClC,OAAO;YAAE,SAAS;YAAM,MAAM,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC;QAAU;IACpE,EAAE,OAAO,KAAK;QACZ,OAAO;YAAE,SAAS;YAAO,OAAO,IAAI,OAAO;QAAC;IAC9C;AACF;;;IArFsB;IAYA;IAYA;IAYA;IAYA;IAeA;IAeA;;AA9EA,+OAAA;AAYA,+OAAA;AAYA,+OAAA;AAYA,+OAAA;AAYA,+OAAA;AAeA,+OAAA;AAeA,+OAAA"}},
    {"offset": {"line": 390, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/ls-customs-mascara/.next-internal/server/app/dashboard/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {listItemsAction as '0004359a9353ace45cae70f12aac6562177dd3cdfc'} from 'ACTIONS_MODULE0'\nexport {searchItemsAction as '4001aaf19d0a3818f909ef6a77bcb602d1cdd456fa'} from 'ACTIONS_MODULE0'\nexport {addManufacturedAction as '40522e1ee9d25763a5cf2137ce6bd15bc6cf9dc820'} from 'ACTIONS_MODULE0'\nexport {addRawAction as '40d4bb175200857cfdd7c985db3421d11cfb42c15f'} from 'ACTIONS_MODULE0'\nexport {deleteItemAction as '40e0318ec770de0b33484c62533fe48f5ca68b4d80'} from 'ACTIONS_MODULE0'\nexport {addStockAction as '60e0ecb56173b9c0e68dad4f3200eb4194eec46c79'} from 'ACTIONS_MODULE0'\nexport {removeStockAction as '60fe4534d097d80684aa0587cdddf208665f5422a2'} from 'ACTIONS_MODULE0'\nexport {listItems as '00a86fdee841422d74f99c4158449cff9d6c42a0f9'} from 'ACTIONS_MODULE1'\nexport {searchItems as '400fc8d113a3dff56f12c6a652022f15cf8171c94e'} from 'ACTIONS_MODULE1'\nexport {deleteItem as '40c4e434e47439b08f766c97eda76d81a1a013935a'} from 'ACTIONS_MODULE1'\nexport {createRaw as '600ccfaf1c1c1d8efcc8efe99ca2e77663eda1d65c'} from 'ACTIONS_MODULE1'\nexport {addStock as '6022ea75f766d7a19968497222058aa6732d836f3f'} from 'ACTIONS_MODULE1'\nexport {removeStock as '6062745cb81f6b8d7724a16ed16d015fb5c7878dc0'} from 'ACTIONS_MODULE1'\nexport {createManufactured as '60dd399b61e7023bb3d9be9f4abd0a5da35dd4b5a3'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AAOA"}}]
}